From 03a0349cfb4d5e42e068ddef4cfdbb022139b861 Mon Sep 17 00:00:00 2001
From: Shawn Wells <shawn@redhat.com>
Date: Mon, 22 Feb 2016 18:18:03 -0500
Subject: [PATCH 1/2] Add RHEL6/7 Compute Node CPEs

---
 shared/oval/installed_OS_is_rhel6.xml | 18 ++++++++++++++----
 shared/oval/installed_OS_is_rhel7.xml | 18 ++++++++++++++----
 2 files changed, 28 insertions(+), 8 deletions(-)

diff --git a/shared/oval/installed_OS_is_rhel6.xml b/shared/oval/installed_OS_is_rhel6.xml
index 8ad16e6..5e86e15 100644
--- a/shared/oval/installed_OS_is_rhel6.xml
+++ b/shared/oval/installed_OS_is_rhel6.xml
@@ -18,10 +18,9 @@
       <criterion comment="Installed operating system is part of the unix family"
       test_ref="test_unix_family" />
       <criteria operator="OR">
-        <criterion comment="Red Hat Enterprise Linux 6 Workstation is installed"
-        test_ref="test_rhel_workstation" />
-        <criterion comment="Red Hat Enterprise Linux 6 Server is installed"
-        test_ref="test_rhel_server" />
+        <criterion comment="RHEL 6 Workstation is installed" test_ref="test_rhel_workstation" />
+        <criterion comment="RHEL 6 Server is installed" test_ref="test_rhel_server" />
+        <criterion comment="RHEL 6 Compute Node is installed" test_ref="test_rhel_server" />
       </criteria>
     </criteria>
   </definition>
@@ -56,4 +55,15 @@
   <linux:rpminfo_object id="obj_rhel_server" version="1">
     <linux:name>redhat-release-server</linux:name>
   </linux:rpminfo_object>
+
+  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-computenode is version 6" id="test_rhel_computenode" version="1">
+    <linux:object object_ref="obj_rhel_computenode" />
+    <linux:state state_ref="state_rhel_computenode" />
+  </linux:rpminfo_test>
+  <linux:rpminfo_state id="state_rhel_computenode" version="1">
+    <linux:version operation="pattern match">^6.*$</linux:version>
+  </linux:rpminfo_state>
+  <linux:rpminfo_object id="obj_rhel_computenode" version="1">
+    <linux:name>redhat-release-computenode</linux:name>
+  </linux:rpminfo_object>
 </def-group>
diff --git a/shared/oval/installed_OS_is_rhel7.xml b/shared/oval/installed_OS_is_rhel7.xml
index 8997f4a..9984986 100644
--- a/shared/oval/installed_OS_is_rhel7.xml
+++ b/shared/oval/installed_OS_is_rhel7.xml
@@ -16,10 +16,9 @@
       <criterion comment="Installed operating system is part of the unix family"
       test_ref="test_rhel7_unix_family" />
       <criteria operator="OR">
-        <criterion comment="Red Hat Enterprise Linux 7 Workstation is installed"
-        test_ref="test_rhel7_workstation" />
-        <criterion comment="Red Hat Enterprise Linux 7 Server is installed"
-        test_ref="test_rhel7_server" />
+        <criterion comment="RHEL 7 Workstation is installed" test_ref="test_rhel7_workstation" />
+        <criterion comment="RHEL 7 Server is installed" test_ref="test_rhel7_server" />
+        <criterion comment="RHEL 7 Compute Node is installed" test_ref="test_rhel7_computenode" />
       </criteria>
     </criteria>
   </definition>
@@ -54,4 +53,15 @@
   <linux:rpminfo_object id="obj_rhel7_server" version="1">
     <linux:name>redhat-release-server</linux:name>
   </linux:rpminfo_object>
+
+  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-computenode is version 7" id="test_rhel7_computenode" version="1">
+    <linux:object object_ref="obj_rhel7_computenode" />
+    <linux:state state_ref="state_rhel7_computenode" />
+  </linux:rpminfo_test>
+  <linux:rpminfo_state id="state_rhel7_computenode" version="1">
+    <linux:version operation="pattern match">^7.*$</linux:version>
+  </linux:rpminfo_state>
+  <linux:rpminfo_object id="obj_rhel7_computenode" version="1">
+    <linux:name>redhat-release-computenode</linux:name>
+  </linux:rpminfo_object>
 </def-group>

From 710b68dcb6710f090453461bdcdec2df0c37e3d2 Mon Sep 17 00:00:00 2001
From: Shawn Wells <shawn@redhat.com>
Date: Mon, 22 Feb 2016 18:19:10 -0500
Subject: [PATCH 2/2] Update RHEL6/7 guide.xml with compute node CPE

---
 RHEL/6/input/guide.xml | 1 +
 RHEL/7/input/guide.xml | 1 +
 2 files changed, 2 insertions(+)

diff --git a/RHEL/6/input/guide.xml b/RHEL/6/input/guide.xml
index 255adc1..b6d4142 100644
--- a/RHEL/6/input/guide.xml
+++ b/RHEL/6/input/guide.xml
@@ -42,5 +42,6 @@ countries. All other names are registered trademarks or trademarks of their
 respective companies.</rear-matter>
 <platform idref="cpe:/o:redhat:enterprise_linux:6" />
 <platform idref="cpe:/o:redhat:enterprise_linux:6::client" />
+<platform idref="cpe:/o:redhat:enterprise_linux:6::computenode" />
 <version>0.9</version>
 </Benchmark>
diff --git a/RHEL/7/input/guide.xml b/RHEL/7/input/guide.xml
index 8ffdbe1..0be5606 100644
--- a/RHEL/7/input/guide.xml
+++ b/RHEL/7/input/guide.xml
@@ -38,5 +38,6 @@ countries. All other names are registered trademarks or trademarks of their
 respective companies.</rear-matter>
 <platform idref="cpe:/o:redhat:enterprise_linux:7" />
 <platform idref="cpe:/o:redhat:enterprise_linux:7::client" />
+<platform idref="cpe:/o:redhat:enterprise_linux:7::computenode" />
 <version>0.9</version>
 </Benchmark>
From 806db87fa36c50f087827314aa59bd07f5867125 Mon Sep 17 00:00:00 2001
From: Jan Lieskovsky <jlieskov@redhat.com>
Date: Fri, 26 Feb 2016 16:23:41 +0100
Subject: [PATCH] [BugFix] [RHEL/6] Add
 "cpe:/o:redhat:enterprise_linux:6::computenode" <xccdf:Platform> definition
 into RHEL-6 CPE dictionary

Fixes: https://github.com/OpenSCAP/scap-security-guide/issues/1060

[BugFix] [RHEL/6] shared/oval/installed_OS_is_rhel6.xml - Fix test
name so on RHEL6 ComputeNode we would truly use ComputeNode test
---
 RHEL/6/input/oval/platform/rhel6-cpe-dictionary.xml | 5 +++++
 shared/oval/installed_OS_is_rhel6.xml               | 2 +-
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/RHEL/6/input/oval/platform/rhel6-cpe-dictionary.xml b/RHEL/6/input/oval/platform/rhel6-cpe-dictionary.xml
index 22db548..36ab227 100644
--- a/RHEL/6/input/oval/platform/rhel6-cpe-dictionary.xml
+++ b/RHEL/6/input/oval/platform/rhel6-cpe-dictionary.xml
@@ -12,6 +12,11 @@
             <!-- the check references an OVAL file that contains an inventory definition -->
             <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="filename">installed_OS_is_rhel6</check>
       </cpe-item>
+      <cpe-item name="cpe:/o:redhat:enterprise_linux:6::computenode">
+            <title xml:lang="en-us">Red Hat Enterprise Linux ComputeNode</title>
+            <!-- the check references an OVAL file that contains an inventory definition -->
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="filename">installed_OS_is_rhel6</check>
+      </cpe-item>
       <cpe-item name="cpe:/o:centos:centos:6">
             <title xml:lang="en-us">CentOS 6</title>
             <!-- the check references an OVAL file that contains an inventory definition -->
diff --git a/shared/oval/installed_OS_is_rhel6.xml b/shared/oval/installed_OS_is_rhel6.xml
index 5e86e15..aa027c1 100644
--- a/shared/oval/installed_OS_is_rhel6.xml
+++ b/shared/oval/installed_OS_is_rhel6.xml
@@ -20,7 +20,7 @@
       <criteria operator="OR">
         <criterion comment="RHEL 6 Workstation is installed" test_ref="test_rhel_workstation" />
         <criterion comment="RHEL 6 Server is installed" test_ref="test_rhel_server" />
-        <criterion comment="RHEL 6 Compute Node is installed" test_ref="test_rhel_server" />
+        <criterion comment="RHEL 6 Compute Node is installed" test_ref="test_rhel_computenode" />
       </criteria>
     </criteria>
   </definition>
From 9d853d73e3747360de56c3612264a68f63e02c7a Mon Sep 17 00:00:00 2001
From: Jan Lieskovsky <jlieskov@redhat.com>
Date: Fri, 13 May 2016 17:02:13 +0200
Subject: [PATCH] [BugFix] [RHEL/7] Fix for issue #1227

Add "cpe:/o:redhat:enterprise_linux:7::client" and
"cpe:/o:redhat:enterprise_linux:7::computenode" into RHEL/7's CPE
dictionary to fix Requirement #15 of SCAP Version 1.2 Requirements
Matrix

Fixes: https://github.com/OpenSCAP/scap-security-guide/issues/1227
---
 RHEL/6/input/oval/platform/rhel6-cpe-dictionary.xml |  2 +-
 RHEL/7/input/oval/platform/rhel7-cpe-dictionary.xml | 10 ++++++++++
 2 files changed, 11 insertions(+), 1 deletion(-)

diff --git a/RHEL/6/input/oval/platform/rhel6-cpe-dictionary.xml b/RHEL/6/input/oval/platform/rhel6-cpe-dictionary.xml
index 36ab227..d452dde 100644
--- a/RHEL/6/input/oval/platform/rhel6-cpe-dictionary.xml
+++ b/RHEL/6/input/oval/platform/rhel6-cpe-dictionary.xml
@@ -13,7 +13,7 @@
             <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="filename">installed_OS_is_rhel6</check>
       </cpe-item>
       <cpe-item name="cpe:/o:redhat:enterprise_linux:6::computenode">
-            <title xml:lang="en-us">Red Hat Enterprise Linux ComputeNode</title>
+            <title xml:lang="en-us">Red Hat Enterprise Linux 6 ComputeNode</title>
             <!-- the check references an OVAL file that contains an inventory definition -->
             <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="filename">installed_OS_is_rhel6</check>
       </cpe-item>
diff --git a/RHEL/7/input/oval/platform/rhel7-cpe-dictionary.xml b/RHEL/7/input/oval/platform/rhel7-cpe-dictionary.xml
index fa1da14..677ad08 100644
--- a/RHEL/7/input/oval/platform/rhel7-cpe-dictionary.xml
+++ b/RHEL/7/input/oval/platform/rhel7-cpe-dictionary.xml
@@ -7,6 +7,16 @@
             <!-- the check references an OVAL file that contains an inventory definition -->
             <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="filename">installed_OS_is_rhel7</check>
       </cpe-item>
+      <cpe-item name="cpe:/o:redhat:enterprise_linux:7::client">
+            <title xml:lang="en-us">Red Hat Enterprise Linux 7 Client</title>
+            <!-- the check references an OVAL file that contains an inventory definition -->
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="filename">installed_OS_is_rhel7</check>
+      </cpe-item>
+      <cpe-item name="cpe:/o:redhat:enterprise_linux:7::computenode">
+            <title xml:lang="en-us">Red Hat Enterprise Linux 7 ComputeNode</title>
+            <!-- the check references an OVAL file that contains an inventory definition -->
+            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="filename">installed_OS_is_rhel7</check>
+      </cpe-item>
       <cpe-item name="cpe:/o:centos:centos:7">
             <title xml:lang="en-us">CentOS 7</title>
             <!-- the check references an OVAL file that contains an inventory definition -->
